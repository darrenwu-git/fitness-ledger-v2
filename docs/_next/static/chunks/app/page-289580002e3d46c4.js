(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{13:(e,s,t)=>{"use strict";t.d(s,{db:()=>i});var r=t(5571);class a extends r.Ay{constructor(){super("FitnessLedgerDB"),this.version(1).stores({workoutEntries:"++id, exerciseName, type, timestamp",userPreferences:"++id"})}}let i=new a},3981:(e,s,t)=>{"use strict";t.d(s,{o:()=>i});var r=t(2698),a=t(13);function i(){let e=(0,r.kk)(()=>a.db.workoutEntries.orderBy("timestamp").reverse().toArray());return{workouts:e,addWorkout:async e=>await a.db.workoutEntries.add(e),deleteWorkout:async e=>await a.db.workoutEntries.delete(e),updateWorkout:async(e,s)=>await a.db.workoutEntries.update(e,s),isLoading:void 0===e}}},4517:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>k});var r=t(5155),a=t(2115),i=t(6909),n=t(4217),l=t(6296),d=t(6204),o=t(3210),c=t(9199),x=t(5243),u=t(7313);let m=`
You are an Expert Fitness Data Analyst. Your task is to extract structured workout details from natural language descriptions.
Rules:
- Always return valid JSON matching the schema.
- Support multiple exercises in one sentence.
- For strength, include 'exerciseName', 'sets' (with 'reps' and 'weight').
- For cardio, include 'exerciseName', 'duration' (minutes).
- Default 'unit' to 'kg' if not specified.
- The output should be a JSON object with a 'workouts' array.

Schema:
{
  "workouts": [
    {
      "exerciseName": string,
      "type": "strength" | "cardio",
      "sets": [{ "reps": number, "weight": number }],
      "duration": number (only for cardio),
      "unit": string
    }
  ]
}
`;async function h(e,s){let t=new u.ij(s).getGenerativeModel({model:"gemini-1.5-flash",generationConfig:{responseMimeType:"application/json"}}),r=`System: ${m}

User: ${e}`,a=await t.generateContent(r),i=(await a.response).text();try{return JSON.parse(i)}catch(e){throw console.error("Failed to parse Gemini response:",i),Error("Invalid response format from AI")}}var g=t(8633),b=t(3981);function p(){let{isRecording:e,transcript:s,error:t,startRecording:u,stopRecording:m,setTranscript:p}=function(){let[e,s]=(0,a.useState)(!1),[t,r]=(0,a.useState)(""),[i,n]=(0,a.useState)(null),l=(0,a.useRef)(null);return(0,a.useEffect)(()=>{"webkitSpeechRecognition"in window||"SpeechRecognition"in window?(l.current=new(window.SpeechRecognition||window.webkitSpeechRecognition),l.current.continuous=!1,l.current.interimResults=!0,l.current.lang="en-US",l.current.onresult=e=>{let s=e.resultIndex;r(e.results[s][0].transcript)},l.current.onerror=e=>{n(e.error),s(!1)},l.current.onend=()=>{s(!1)}):n("Speech Recognition is not supported in this browser.")},[]),{isRecording:e,transcript:t,error:i,startRecording:(0,a.useCallback)(()=>{l.current&&(n(null),r(""),s(!0),l.current.start())},[]),stopRecording:(0,a.useCallback)(()=>{l.current&&(l.current.stop(),s(!1))},[]),setTranscript:r}}(),{preferences:y}=(0,g.t)(),{addWorkout:w}=(0,b.o)(),[f,j]=(0,a.useState)(!1),[N,k]=(0,a.useState)(null),[v,A]=(0,a.useState)("idle"),S=async()=>{if(s&&y?.geminiApiKey){j(!0);try{let e=await h(s,y.geminiApiKey);k(e.workouts)}catch(e){console.error(e),alert("Failed to parse workout. Please check your API key or try again.")}finally{j(!1)}}},E=async()=>{if(N){A("saving");try{for(let e of N){let s={exerciseName:e.exerciseName,type:e.type,timestamp:Date.now(),sets:e.sets,duration:e.duration,source:"voice",notes:""};await w(s)}A("saved"),setTimeout(()=>{A("idle"),k(null),p("")},2e3)}catch(e){console.error(e),alert("Failed to save workout."),A("idle")}}},F=()=>{k(null),p("")};return(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[(0,r.jsx)(i.A,{className:"w-5 h-5 text-blue-500"}),"Voice Record"]}),N?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center border-b pb-2 mb-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-green-600 flex items-center gap-1",children:"Detected Workouts"}),(0,r.jsx)("button",{onClick:F,className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)(o.A,{className:"w-5 h-5"})})]}),(0,r.jsx)("div",{className:"space-y-3 max-h-[300px] overflow-y-auto pr-1",children:N.map((e,s)=>(0,r.jsxs)("div",{className:"p-3 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800",children:[(0,r.jsx)("div",{className:"font-semibold text-lg",children:e.exerciseName}),(0,r.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"strength"===e.type?(0,r.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:e.sets.map((s,t)=>(0,r.jsxs)("span",{className:"bg-white dark:bg-gray-800 px-2 py-0.5 rounded border border-blue-200 dark:border-blue-700",children:[s.reps," \xd7 ",s.weight,e.unit||"kg"]},t))}):(0,r.jsxs)("div",{className:"mt-1",children:["Duration: ",e.duration," min"]})})]},s))}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("button",{onClick:F,className:"flex-1 py-3 px-4 border border-gray-200 dark:border-gray-700 rounded-xl flex items-center justify-center gap-2 font-semibold",children:[(0,r.jsx)(c.A,{className:"w-5 h-5"}),"Discard"]}),(0,r.jsx)("button",{onClick:E,disabled:"saving"===v,className:"flex-[2] py-3 px-4 bg-green-600 hover:bg-green-700 text-white rounded-xl flex items-center justify-center gap-2 font-semibold transition-all",children:"saved"===v?(0,r.jsx)(r.Fragment,{children:"Saved!"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.A,{className:"w-5 h-5"}),"Save to Ledger"]})})]})]}):(0,r.jsxs)("div",{className:"space-y-4 text-center",children:[(0,r.jsx)("div",{className:`w-24 h-24 mx-auto flex items-center justify-center rounded-full transition-all duration-300 ${e?"bg-red-100 text-red-600 animate-pulse scale-110 shadow-lg shadow-red-200":"bg-blue-50 text-blue-600"}`,onMouseDown:u,onMouseUp:m,onTouchStart:u,onTouchEnd:m,children:e?(0,r.jsx)(n.A,{className:"w-10 h-10"}):(0,r.jsx)(i.A,{className:"w-10 h-10"})}),(0,r.jsx)("p",{className:"text-sm font-medium",children:e?"Listening...":"Hold to speak"}),(0,r.jsx)("div",{className:"min-h-[60px] p-3 rounded-lg bg-gray-50 dark:bg-gray-900 border border-dashed border-gray-300 dark:border-gray-600",children:s||(0,r.jsx)("span",{className:"text-gray-400 italic",children:'"I did 3 sets of 10 squats at 80kg"'})}),t&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-2",children:t}),s&&!e&&(0,r.jsx)("button",{onClick:S,disabled:f||!y?.geminiApiKey,className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl flex items-center justify-center gap-2 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:f?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.A,{className:"w-5 h-5 animate-spin"}),"Analyzing..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.A,{className:"w-5 h-5"}),"Process with Gemini"]})}),!y?.geminiApiKey&&(0,r.jsx)("p",{className:"text-amber-600 text-xs mt-2",children:"⚠️ Gemini API key missing. Go to Settings."})]})]})})}var y=t(538),w=t(3219),f=t(4071),j=t(8500),N=t.n(j);function k(){let{workouts:e}=(0,b.o)(),s=e?.slice(0,3)||[];return(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("header",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"Fitness Ledger"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Track your gains with voice."})]}),(0,r.jsx)(p,{}),(0,r.jsxs)("section",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[(0,r.jsx)(y.A,{className:"w-5 h-5 text-purple-500"}),"Recent Activity"]}),(0,r.jsx)(N(),{href:"/history",className:"text-blue-600 text-sm font-medium",children:"View All"})]}),s.length>0?(0,r.jsx)("div",{className:"space-y-3",children:s.map((e,s)=>(0,r.jsx)("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-bold",children:e.exerciseName}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.timestamp).toLocaleDateString()})]}),(0,r.jsx)("div",{className:"text-right",children:"strength"===e.type?(0,r.jsxs)("span",{className:"text-sm font-medium text-blue-600",children:[e.sets?.length," sets"]}):(0,r.jsxs)("span",{className:"text-sm font-medium text-green-600",children:[e.duration," min"]})})]})},e.id||s))}):(0,r.jsxs)("div",{className:"p-8 text-center bg-gray-50 dark:bg-gray-900 rounded-2xl border border-dashed border-gray-200 dark:border-gray-800",children:[(0,r.jsx)(w.A,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-gray-500",children:"No workouts recorded yet."})]})]}),(0,r.jsxs)("section",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)(N(),{href:"/dashboard",className:"p-4 bg-blue-600 text-white rounded-2xl flex flex-col justify-between h-32 shadow-lg shadow-blue-200 dark:shadow-none",children:[(0,r.jsx)(f.A,{className:"w-8 h-8 opacity-50"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:"Progress"}),(0,r.jsx)("div",{className:"text-xs opacity-80",children:"See your gains"})]})]}),(0,r.jsxs)(N(),{href:"/settings",className:"p-4 bg-gray-100 dark:bg-gray-800 rounded-2xl flex flex-col justify-between h-32",children:[(0,r.jsx)(w.A,{className:"w-8 h-8 text-gray-400"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:"Stats"}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"View metrics"})]})]})]})]})}},5539:(e,s,t)=>{Promise.resolve().then(t.bind(t,4517))},8633:(e,s,t)=>{"use strict";t.d(s,{t:()=>i});var r=t(2698),a=t(13);function i(){let e=(0,r.kk)(()=>a.db.userPreferences.get(1));return{preferences:e,saveSettings:async e=>await a.db.userPreferences.get(1)?await a.db.userPreferences.update(1,e):await a.db.userPreferences.add({id:1,geminiApiKey:"",preferredUnit:"kg",theme:"system",...e}),isLoading:void 0===e}}}},e=>{e.O(0,[138,405,490,441,928,358],()=>e(e.s=5539)),_N_E=e.O()}]);